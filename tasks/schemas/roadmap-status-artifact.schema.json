{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://tau.njf.io/schemas/roadmap-status-artifact.schema.json",
  "title": "Roadmap Status Artifact",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version",
    "generated_at",
    "repository",
    "source_mode",
    "config_path",
    "summary",
    "todo_groups",
    "epics",
    "gap",
    "issue_states"
  ],
  "properties": {
    "schema_version": {
      "type": "integer",
      "const": 1
    },
    "generated_at": {
      "type": "string",
      "format": "date-time"
    },
    "repository": {
      "type": "string",
      "minLength": 1
    },
    "source_mode": {
      "type": "string",
      "enum": [
        "fixture",
        "live"
      ]
    },
    "config_path": {
      "type": "string",
      "minLength": 1
    },
    "summary": {
      "$ref": "#/$defs/summaryCounts"
    },
    "todo_groups": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/groupStatus"
      }
    },
    "epics": {
      "$ref": "#/$defs/epicStatus"
    },
    "gap": {
      "$ref": "#/$defs/gapStatus"
    },
    "issue_states": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/issueState"
      }
    }
  },
  "$defs": {
    "summaryCounts": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "tracked_issue_count",
        "closed_count",
        "open_count",
        "unknown_count",
        "all_closed"
      ],
      "properties": {
        "tracked_issue_count": {
          "type": "integer",
          "minimum": 0
        },
        "closed_count": {
          "type": "integer",
          "minimum": 0
        },
        "open_count": {
          "type": "integer",
          "minimum": 0
        },
        "unknown_count": {
          "type": "integer",
          "minimum": 0
        },
        "all_closed": {
          "type": "boolean"
        }
      }
    },
    "groupStatus": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "label",
        "issue_ids",
        "closed_count",
        "open_count",
        "unknown_count",
        "total_count",
        "all_closed"
      ],
      "properties": {
        "label": {
          "type": "string",
          "minLength": 1
        },
        "issue_ids": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 1
          }
        },
        "closed_count": {
          "type": "integer",
          "minimum": 0
        },
        "open_count": {
          "type": "integer",
          "minimum": 0
        },
        "unknown_count": {
          "type": "integer",
          "minimum": 0
        },
        "total_count": {
          "type": "integer",
          "minimum": 0
        },
        "all_closed": {
          "type": "boolean"
        }
      }
    },
    "epicStatus": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "label",
        "issue_ids",
        "closed_count",
        "open_count",
        "unknown_count",
        "total_count",
        "all_closed"
      ],
      "properties": {
        "label": {
          "type": "string",
          "minLength": 1
        },
        "issue_ids": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 1
          }
        },
        "closed_count": {
          "type": "integer",
          "minimum": 0
        },
        "open_count": {
          "type": "integer",
          "minimum": 0
        },
        "unknown_count": {
          "type": "integer",
          "minimum": 0
        },
        "total_count": {
          "type": "integer",
          "minimum": 0
        },
        "all_closed": {
          "type": "boolean"
        }
      }
    },
    "gapStatus": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "core_delivery_pr_span",
        "child_story_task_ids",
        "child_story_task_closed_count",
        "child_story_task_open_count",
        "child_story_task_unknown_count",
        "child_story_task_total_count",
        "child_story_task_all_closed",
        "epic_summary"
      ],
      "properties": {
        "core_delivery_pr_span": {
          "type": "object",
          "additionalProperties": false,
          "required": [
            "from",
            "to"
          ],
          "properties": {
            "from": {
              "type": "integer",
              "minimum": 1
            },
            "to": {
              "type": "integer",
              "minimum": 1
            }
          }
        },
        "child_story_task_ids": {
          "type": "array",
          "items": {
            "type": "integer",
            "minimum": 1
          }
        },
        "child_story_task_closed_count": {
          "type": "integer",
          "minimum": 0
        },
        "child_story_task_open_count": {
          "type": "integer",
          "minimum": 0
        },
        "child_story_task_unknown_count": {
          "type": "integer",
          "minimum": 0
        },
        "child_story_task_total_count": {
          "type": "integer",
          "minimum": 0
        },
        "child_story_task_all_closed": {
          "type": "boolean"
        },
        "epic_summary": {
          "type": "string",
          "minLength": 1
        }
      }
    },
    "issueState": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "number",
        "state"
      ],
      "properties": {
        "number": {
          "type": "integer",
          "minimum": 1
        },
        "state": {
          "type": "string",
          "enum": [
            "OPEN",
            "CLOSED",
            "UNKNOWN"
          ]
        }
      }
    }
  }
}
