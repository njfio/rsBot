{
  "schema_version": 1,
  "cases": [
    {
      "name": "baseline_mixed_sign_advantage",
      "tolerance": 1e-12,
      "config": {
        "clip_epsilon": 0.2,
        "value_loss_coefficient": 0.5,
        "entropy_coefficient": 0.01,
        "mini_batch_size": 2,
        "gradient_accumulation_steps": 1
      },
      "samples": [
        {
          "old_logprob": -0.2,
          "new_logprob": -0.1,
          "advantage": 1.0,
          "return_value": 1.2,
          "value_prediction": 1.0,
          "entropy": 0.7
        },
        {
          "old_logprob": -0.3,
          "new_logprob": -0.6,
          "advantage": -0.5,
          "return_value": -0.2,
          "value_prediction": 0.1,
          "entropy": 0.5
        }
      ],
      "expected_loss": {
        "policy_loss": -0.35258545903782385,
        "value_loss": 0.0325,
        "entropy_bonus": 0.6,
        "total_loss": -0.34233545903782384,
        "mean_ratio": 0.9229945693786827,
        "clipped_fraction": 0.5,
        "approx_kl": 0.025
      }
    },
    {
      "name": "clipping_edge_high_and_low_ratios",
      "tolerance": 1e-12,
      "config": {
        "clip_epsilon": 0.2,
        "value_loss_coefficient": 0.5,
        "entropy_coefficient": 0.01,
        "mini_batch_size": 2,
        "gradient_accumulation_steps": 1
      },
      "samples": [
        {
          "old_logprob": -1.0,
          "new_logprob": -0.1,
          "advantage": 0.5,
          "return_value": 0.2,
          "value_prediction": 0.1,
          "entropy": 0.3
        },
        {
          "old_logprob": -0.1,
          "new_logprob": -1.2,
          "advantage": -0.7,
          "return_value": -0.4,
          "value_prediction": -0.2,
          "entropy": 0.25
        }
      ],
      "expected_loss": {
        "policy_loss": -0.020000000000000018,
        "value_loss": 0.012500000000000002,
        "entropy_bonus": 0.275,
        "total_loss": -0.016500000000000015,
        "mean_ratio": 1.3962370974275147,
        "clipped_fraction": 1.0,
        "approx_kl": 0.505
      }
    }
  ]
}
